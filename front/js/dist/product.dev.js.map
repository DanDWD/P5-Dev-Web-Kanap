{"version":3,"sources":["product.js"],"names":["paramsUrl","URLSearchParams","document","location","search","articleId","get","fetch","then","response","json","articleInfos","console","table","displayArticleInfos","getElementById","textContent","name","price","description","querySelector","innerHTML","imageUrl","altTxt","colors","renderColor","forEach","color","newHtml","article","quantity","addToCart","articleData","button","colorSelected","quantitySelected","addEventListener","event","preventDefault","selected","product","_id","value","Number","inCart","JSON","parse","localStorage","getItem","setItem","stringify","some","i","id","duplicateId","cart","findIndex","e","push","selection","alert"],"mappings":"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","sourcesContent":["//----recuperation de l'url\r\nlet paramsUrl = new URLSearchParams(document.location.search);\r\nlet articleId = paramsUrl.get(\"id\"); // recuperation de l'id\r\n\r\n//----recuperation des differentes infos des articles dans l'api\r\nfetch(`http://localhost:3000/api/products/${articleId}`)\r\n\r\n//----conversion format json, renommage\r\n.then ((response) => response.json())\r\n    .then((articleInfos) => {   \r\n        console.table(articleInfos);\r\n        displayArticleInfos(articleInfos); // appel de la fonction\r\n    })\r\n\r\n//----insertion des information produits dans le code \r\nfunction displayArticleInfos(articleInfos) {\r\n    document.getElementById(\"title\").textContent = articleInfos.name;\r\n    document.getElementById(\"price\").textContent = articleInfos.price;\r\n    document.getElementById(\"description\").textContent = articleInfos.description;\r\n    document.querySelector(\".item__img\").innerHTML = `\r\n        <img src=\"${articleInfos.imageUrl}\" alt=\"${articleInfos.altTxt}\">`;\r\n    \r\n    //----choix des couleurs\r\n    let colors = articleInfos.colors;\r\n\r\n    //----creation d'un rendu\r\n    let renderColor = \"\";\r\n\r\n    colors.forEach(color => {\r\n        let newHtml = `\r\n            <option value=\"${color}\">${color}</option>`;\r\n        renderColor = renderColor+newHtml; // stocker le rendu en memoire\r\n    });\r\n\r\n    //----l'html est injecte dans le code\r\n    document.getElementById(\"colors\").innerHTML = renderColor;\r\n};\r\n\r\n//----creation d'un modele qui servira pour les articles selectionnés\r\nclass article {\r\n    constructor(articleId, color, quantity) {\r\n      this.articleId = articleId;\r\n      this.color = color;\r\n      this.quantity = quantity;\r\n    }\r\n};\r\n\r\n//----recuperer le choix du prospect \r\nfunction addToCart(){\r\n    let articleData = displayArticleInfos(articleInfos); // article choisi\r\n    const button = document.querySelector(\"#addToCart\");     // ciblage sur le bouton d'ajout\r\n    const colorSelected = document.querySelector(\"#colors\");     // ciblage sur selection de la couleur\r\n    const quantitySelected = document.querySelector(\"#quantity\");     // ciblage sur selection de la quantité\r\n\r\n    //----ecoute du bouton d'ajout\r\n    button.addEventListener(\"click\", (event) => {\r\n        event.preventDefault(); // bloquer les evenements par defaut\r\n\r\n        //---Creation de l'objet de recuperation de la saisie de l'utilisateur\r\n        let selected = new product(\r\n            articleData._id,\r\n            colorSelected.value,\r\n            Number(quantitySelected.value)\r\n            );\r\n\r\n        if (selected.quantity >= 1 && selected.quantity <= 100) { // controle de la quantité 1=>100\r\n            let inCart = JSON.parse(localStorage.getItem(\"laSelection\")); // envoi de la selection vers localstorage\r\n    \r\n            if (inCart == null) { // si le panier n'a pas de valeur\r\n                let inCart = [selected]; // on lui en donne une\r\n                localStorage.setItem(\"laSelection\", JSON.stringify(inCart));\r\n\r\n            } else if (inCart.some(i => // verifier si l'article existe deja\r\n                i.id === selected.id &&\r\n                i.color === selected.color) == true) {\r\n                    const duplicateId = cart.findIndex(e => // on prend son id\r\n                        e.id === selected.id &&\r\n                        e.color === selected.color);\r\n                    cart[duplicateId].quantity = cart[duplicateId].quantity + selected.quantity; // et on additionne les deux valeurs\r\n                    localStorage.setItem(\"laSelection\", JSON.stringify(cart)); // enfin le panier se met a jour\r\n            } else { // si l'article est le premier de son genre\r\n                cart.push(selection);\r\n                localStorage.setItem(\"laSelection\", JSON.stringify(cart));\r\n            };\r\n        } else { // enfin si la quantité est inferieur ou superieur a [1-100]\r\n            alert(\"la quantité doit être comprise entre 1 et 100.\"); // envoyer un message d'avertissement au client\r\n        }\r\n    });\r\n};"],"file":"product.dev.js"}